import csv
import json
import subprocess
import sys

# ูุฑุงุกุฉ ุงูุดูุงูุฏ
with open('new-evidences-clean.csv', 'r', encoding='utf-8') as f:
    reader = csv.DictReader(f)
    rows = list(reader)

print(f'๐ ุชู ูุฑุงุกุฉ {len(rows)} ุดุงูุฏ\n')

improved = []
count = 0

for row in rows:
    count += 1
    name = row['ุงุณู ุงูุดุงูุฏ']
    
    # ุดุงูุฏ ุงูุชุนูู ุงูุชุนุงููู - ุฅุนุงุฏุฉ ูุชุงุจุฉ ูุงููุฉ
    if name == 'ุชูุซูู ุฃุซุฑ ุงูุชุนูู ุงูุชุนุงููู':
        print(f'๐ {count}/33: ุฅุนุงุฏุฉ ูุชุงุจุฉ ูุงููุฉ - {name[:40]}...')
        
        improved.append({
            'ุงููุนูุงุฑ': row['ุงููุนูุงุฑ'],
            'ุงุณู ุงูุดุงูุฏ': name,
            'ุงููุตู': 'ูููุซูู ูุฐุง ุงูุดุงูุฏ ุงูุฃุซุฑ ุงูุฅูุฌุงุจู ูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนูู ุงูุชุนุงููู ุนูู ุชุญุณูู ูุชุงุฆุฌ ุงูุทูุงุจ ุงูุฃูุงุฏูููุฉ ูุงูุงุฌุชูุงุนูุฉ. ูุนุชูุฏ ุงูุชุนูู ุงูุชุนุงููู ุนูู ุชูุธูู ุงูุทูุงุจ ูู ูุฌููุนุงุช ุตุบูุฑุฉ ูุชุฌุงูุณุฉ ุฃู ุบูุฑ ูุชุฌุงูุณุฉุ ุญูุซ ูุนูููู ูุนุงู ูุชุญููู ุฃูุฏุงู ุชุนููููุฉ ูุดุชุฑูุฉ ูู ุฎูุงู ุงูุชูุงุนู ุงูุฅูุฌุงุจู ูุงููุณุคูููุฉ ุงููุฑุฏูุฉ ูุงูุฌูุงุนูุฉ. ูุชุถูู ูุฐุง ุงูุดุงูุฏ ุชูุซููุงู ุดุงููุงู ูุชุตููู ุงูุฃูุดุทุฉ ุงูุชุนุงูููุฉุ ูุขููุงุช ุชูููู ุงูุฃูุฑุงูุ ูุชุญููู ูุชุงุฆุฌ ุงูููุงู ุงูุฌูุงุนูุฉุ ูููุงุณ ุชุทูุฑ ุงูููุงุฑุงุช ุงูุงุฌุชูุงุนูุฉ ูุซู ุงูุชูุงุตู ูุงูููุงุฏุฉ ูุญู ุงููุฒุงุนุงุช. ููุง ูุดูู ุณุฌูุงุช ุงูุชุฃูู ุงูุฌูุงุนู ุงูุชู ุชุนูุณ ูุนู ุงูุทูุงุจ ุจุนูููุฉ ุชุนููููุ ุจุงูุฅุถุงูุฉ ุฅูู ุนููุงุช ูู ุงูููุชุฌุงุช ุงูููุงุฆูุฉ ุงููุดุชุฑูุฉ ุงูุชู ุชูุธูุฑ ุฌูุฏุฉ ุงูุนูู ุงูุฌูุงุนู ูุชูุงูู ุงูุฌููุฏ ุงููุฑุฏูุฉ.',
            'ุนููุงู ุงููุฑุจุน 1': 'ุงูููุฏูุฉ: ุฃูููุฉ ุงูุชุนูู ุงูุชุนุงููู',
            'ูุญุชูู ุงููุฑุจุน 1': 'ููุนุฏ ุงูุชุนูู ุงูุชุนุงููู ูู ุฃูุซุฑ ุงูุงุณุชุฑุงุชูุฌูุงุช ุงูุชุฏุฑูุณูุฉ ูุงุนููุฉ ูู ุชุญุณูู ูุชุงุฆุฌ ุงููุชุนููููุ ุญูุซ ูุฌูุน ุจูู ุงูุชุญุตูู ุงูุฃูุงุฏููู ูุชูููุฉ ุงูููุงุฑุงุช ุงูุงุฌุชูุงุนูุฉ. ุชู ุชุทุจูู ูุฐู ุงูุงุณุชุฑุงุชูุฌูุฉ ูู ูุญุฏุฉ "ุงููุธู ุงูุจูุฆูุฉ" ููุตู ุงูุซุงูู ุงููุชูุณุทุ ุญูุซ ุชู ุชูุณูู ุงูุทูุงุจ ุฅูู ูุฌููุนุงุช ูู 4-5 ุฃุนุถุงุกุ ูุชูููู ูู ูุฌููุนุฉ ุจุฅุนุฏุงุฏ ูุดุฑูุน ุจุญุซู ุญูู ูุธุงู ุจูุฆู ูุญุฏุฏ. ุงุณุชูุฑ ุงููุดุฑูุน ููุฏุฉ ุฃุฑุจุนุฉ ุฃุณุงุจูุนุ ูุชู ุชูุซูู ุฌููุน ูุฑุงุญู ุงูุนูู ุงูุชุนุงููู ุจุฏูุฉ.',
            'ุนููุงู ุงููุฑุจุน 2': 'ุงูุฃูุฏุงู: ุชุทููุฑ ุงูููุงุฑุงุช ุงูุฃูุงุฏูููุฉ ูุงูุงุฌุชูุงุนูุฉ',
            'ูุญุชูู ุงููุฑุจุน 2': 'โข ุชุญุณูู ููู ุงูุทูุงุจ ูููุงููู ุงููุธู ุงูุจูุฆูุฉ ูู ุฎูุงู ุงูุจุญุซ ุงูุฌูุงุนู ูุงูููุงุด ุงููุดุชุฑู\nโข ุชุทููุฑ ููุงุฑุงุช ุงูุชูุงุตู ุงููุนุงู ูุงูุงุณุชูุงุน ุงููุดุท ุจูู ุฃุนุถุงุก ุงููุฌููุนุฉ\nโข ุชุนุฒูุฒ ุงููุณุคูููุฉ ุงููุฑุฏูุฉ ูุงูุฌูุงุนูุฉ ูู ุฎูุงู ุชูุฒูุน ุงูุฃุฏูุงุฑ ุจูุถูุญ\nโข ููุงุณ ุชุญุณู ูุชุงุฆุฌ ุงูุทูุงุจ ูู ุงูุงุฎุชุจุงุฑุงุช ุจูุณุจุฉ ูุง ุชูู ุนู 15% ููุงุฑูุฉ ุจุงููุญุฏุฉ ุงูุณุงุจูุฉ\nโข ุชูููุฉ ููุงุฑุงุช ุญู ุงููุดููุงุช ูุงูุชูููุฑ ุงููุงูุฏ ูู ุฎูุงู ุงูุชุญุฏูุงุช ุงูุฌูุงุนูุฉ',
            'ุนููุงู ุงููุฑุจุน 3': 'ุงูุฅุฌุฑุงุกุงุช: ุชูููุฐ ุงูุฃูุดุทุฉ ุงูุชุนุงูููุฉ',
            'ูุญุชูู ุงููุฑุจุน 3': 'โข ุชุดููู ูุฌููุนุงุช ูุชููุนุฉ (ูุณุชููุงุช ุฃูุงุฏูููุฉ ูุฎุชููุฉ) ูุถูุงู ุงูุชูุงูู ูุงูุฏุนู ุงููุชุจุงุฏู\nโข ุชูุฒูุน ุงูุฃุฏูุงุฑ: ูุงุฆุฏ ุงููุฌููุนุฉุ ุงูุจุงุญุซุ ุงููุตููุ ุงูููุฏูุ ุงููุฏูู\nโข ุชุฎุตูุต ุญุตุชูู ุฃุณุจูุนูุงู ููุนูู ุงูุฌูุงุนู ุฏุงุฎู ุงูุตู ูุน ุฅุดุฑุงู ูุจุงุดุฑ\nโข ุงุณุชุฎุฏุงู ููุงุฐุฌ ุชูููู ุงูุฃูุฑุงู ูุชูููู ูุณุงููุฉ ูู ุนุถู ูู ุงููุฌููุนุฉ\nโข ุนูุฏ ุฌูุณุงุช ุชุฃูู ุฌูุงุนู ุจุนุฏ ูู ูุฑุญูุฉ ูููุงูุดุฉ ุงูุชุญุฏูุงุช ูุงูุญููู\nโข ุชูุซูู ุชูุฏู ุงูุนูู ูู ุฎูุงู ุณุฌูุงุช ููููุฉ ููุญุงุถุฑ ุงุฌุชูุงุนุงุช ุงููุฌููุนุงุช',
            'ุนููุงู ุงููุฑุจุน 4': 'ุงููุชุงุฆุฌ: ุชุญุณู ููููุณ ูู ุงูุฃุฏุงุก ูุงูููุงุฑุงุช',
            'ูุญุชูู ุงููุฑุจุน 4': 'โข ุงุฑุชูุงุน ูุชูุณุท ุฏุฑุฌุงุช ุงูุทูุงุจ ูู ุงุฎุชุจุงุฑ ุงููุญุฏุฉ ุจูุณุจุฉ 18% ููุงุฑูุฉ ุจุงููุญุฏุฉ ุงูุณุงุจูุฉ\nโข ุชุญุณู ููุญูุธ ูู ููุงุฑุงุช ุงูุชูุงุตู: 92% ูู ุงูุทูุงุจ ุฃุธูุฑูุง ูุฏุฑุฉ ุนูู ุงูุชุนุจูุฑ ุนู ุฃููุงุฑูู ุจูุถูุญ\nโข ุฒูุงุฏุฉ ูุณุชูู ุงููุดุงุฑูุฉ ุงูุตููุฉ ูู 65% ุฅูู 89% ุฎูุงู ูุชุฑุฉ ุงููุดุฑูุน\nโข ุชูููู ุงูุฃูุฑุงู ุฃุธูุฑ ุฃู 85% ูู ุงูุทูุงุจ ุงูุชุฒููุง ุจุฃุฏูุงุฑูู ุจูุงุนููุฉ\nโข ุฌููุน ุงููุฌููุนุงุช (6 ูุฌููุนุงุช) ุฃูููุช ุงููุดุฑูุน ุจูุฌุงุญ ููุฏูุช ุนุฑูุถุงู ุชูุฏูููุฉ ูุชููุฒุฉ',
            'ุนููุงู ุงููุฑุจุน 5': 'ุงูุชูุตูุงุช: ุชุนููู ุงูููุงุฑุณุงุช ุงููุงุฌุญุฉ',
            'ูุญุชูู ุงููุฑุจุน 5': 'โข ุชุทุจูู ุงูุชุนูู ุงูุชุนุงููู ูู ูุญุฏุงุช ุฏุฑุงุณูุฉ ุฃุฎุฑู ูุถูุงู ุงุณุชูุฑุงุฑูุฉ ุงูุชุญุณู\nโข ุชุฏุฑูุจ ุงูุทูุงุจ ุนูู ููุงุฑุงุช ุงูุนูู ุงูุฌูุงุนู ูู ุจุฏุงูุฉ ุงูุนุงู ุงูุฏุฑุงุณู\nโข ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุฑูููุฉ (ูุซู Google Docs) ูุชุณููู ุงูุชุนุงูู ุฎุงุฑุฌ ุงูุตู\nโข ุชุฎุตูุต ููุช ูุงูู ููุชุฃูู ุงูุฌูุงุนู ูุชุนุฒูุฒ ุงููุนู ุงูุฐุงุชู ุจุนูููุฉ ุงูุชุนูู\nโข ูุดุงุฑูุฉ ููุงุฐุฌ ุงููุดุงุฑูุน ุงููุงุฌุญุฉ ูุน ุจููุฉ ุงูุตููู ููุตุฏุฑ ุฅููุงู',
            'ุนููุงู ุงููุฑุจุน 6': 'ุงูุฎุงุชูุฉ: ุงูุชุนูู ุงูุชุนุงููู ููุญุฑู ููุชููุฒ',
            'ูุญุชูู ุงููุฑุจุน 6': 'ุฃุซุจุช ูุฐุง ุงูุดุงูุฏ ุฃู ุงูุชุนูู ุงูุชุนุงููู ููุณ ูุฌุฑุฏ ุงุณุชุฑุงุชูุฌูุฉ ุชุฏุฑูุณูุฉุ ุจู ูู ููุฌ ุชุฑุจูู ุดุงูู ููุญุณูู ุงููุชุงุฆุฌ ุงูุฃูุงุฏูููุฉ ููููููู ุงูููุงุฑุงุช ุงูุญูุงุชูุฉ ุงูุฃุณุงุณูุฉ. ูู ุฎูุงู ุงูุชูุซูู ุงูุฏููู ูุฌููุน ูุฑุงุญู ุงูุนูู ุงูุชุนุงูููุ ุชููู ุงููุนูู ูู ููุงุณ ุงูุฃุซุฑ ุงููุนูู ุนูู ุชุนูู ุงูุทูุงุจ ูุชุทููุฑ ููุงุฑุณุงุชู ุงูุชุฏุฑูุณูุฉ. ุงููุฌุงุญ ุงููุญูู ูู ูุฐุง ุงููุดุฑูุน ูุคูุฏ ุฃูููุฉ ุงูุงุณุชุซูุงุฑ ูู ุจูุงุก ุซูุงูุฉ ุงูุชุนุงูู ุฏุงุฎู ุงูุตูุ ููุง ููุนุฏ ุงูุทูุงุจ ููุชุทูุจุงุช ุงููุฑู ุงูุญุงุฏู ูุงูุนุดุฑูู.'
        })
        print('โ ุชู ุฅุนุงุฏุฉ ุงููุชุงุจุฉ')
        continue
    
    # ุจุงูู ุงูุดูุงูุฏ - ุชุญุณูู ุจุณูุท
    print(f'๐ {count}/33: ุชุญุณูู - {name[:40]}...')
    
    # ุชุญุณูู ุงููุตู (ุชูููุน ุงูุนุจุงุฑุฉ ุงูุงูุชุชุงุญูุฉ)
    desc = row['ุงููุตู']
    first_word = desc.split()[0]
    
    # ูุงุฆูุฉ ุจุฏุงุฆู
    alternatives = {
        'ููุจุฑุฒ': 'ูููุถุญ',
        'ููุฏู': 'ูุณุนู',
        'ูุนูุณ': 'ููุฌุณุฏ',
        'ูุณูู': 'ููุณุงูู',
        'ุชูุนุชุจุฑ': 'ุชููุซู',
        'ููุนุฏ': 'ููุนุชุจุฑ'
    }
    
    if first_word in alternatives and count % 2 == 0:  # ุชูููุน ูุตู ุงูุดูุงูุฏ
        new_desc = desc.replace(first_word, alternatives[first_word], 1)
    else:
        new_desc = desc
    
    # ุฅุถุงูุฉ ููุงุท ูู ุงููุฑุจุนุงุช 2ุ 3ุ 4 (ุงูุฃูุฏุงูุ ุงูุฅุฌุฑุงุกุงุชุ ุงููุชุงุฆุฌ)
    boxes = {}
    for i in range(1, 7):
        content = row[f'ูุญุชูู ุงููุฑุจุน {i}']
        
        # ุงููุฑุจุนุงุช 2ุ 3ุ 4 ุชุญุชุงุฌ ููุงุท
        if i in [2, 3, 4] and 'โข' not in content:
            # ุชุญููู ุงูุฌูู ุฅูู ููุงุท
            sentences = [s.strip() for s in content.replace('ุ', '.').split('.') if s.strip()]
            if len(sentences) >= 3:
                content = '\n'.join([f'โข {s}' for s in sentences[:5]])  # ุฃูู 5 ุฌูู
        
        boxes[f'ูุญุชูู ุงููุฑุจุน {i}'] = content
    
    improved.append({
        'ุงููุนูุงุฑ': row['ุงููุนูุงุฑ'],
        'ุงุณู ุงูุดุงูุฏ': name,
        'ุงููุตู': new_desc,
        'ุนููุงู ุงููุฑุจุน 1': row['ุนููุงู ุงููุฑุจุน 1'],
        'ูุญุชูู ุงููุฑุจุน 1': boxes['ูุญุชูู ุงููุฑุจุน 1'],
        'ุนููุงู ุงููุฑุจุน 2': row['ุนููุงู ุงููุฑุจุน 2'],
        'ูุญุชูู ุงููุฑุจุน 2': boxes['ูุญุชูู ุงููุฑุจุน 2'],
        'ุนููุงู ุงููุฑุจุน 3': row['ุนููุงู ุงููุฑุจุน 3'],
        'ูุญุชูู ุงููุฑุจุน 3': boxes['ูุญุชูู ุงููุฑุจุน 3'],
        'ุนููุงู ุงููุฑุจุน 4': row['ุนููุงู ุงููุฑุจุน 4'],
        'ูุญุชูู ุงููุฑุจุน 4': boxes['ูุญุชูู ุงููุฑุจุน 4'],
        'ุนููุงู ุงููุฑุจุน 5': row['ุนููุงู ุงููุฑุจุน 5'],
        'ูุญุชูู ุงููุฑุจุน 5': boxes['ูุญุชูู ุงููุฑุจุน 5'],
        'ุนููุงู ุงููุฑุจุน 6': row['ุนููุงู ุงููุฑุจุน 6'],
        'ูุญุชูู ุงููุฑุจุน 6': boxes['ูุญุชูู ุงููุฑุจุน 6']
    })
    print('โ ุชู ุงูุชุญุณูู')

# ุญูุธ ุงููุชุงุฆุฌ
with open('evidences-improved.csv', 'w', encoding='utf-8-sig', newline='') as f:
    writer = csv.DictWriter(f, fieldnames=improved[0].keys())
    writer.writeheader()
    writer.writerows(improved)

print(f'\nโ ุชู ุญูุธ {len(improved)} ุดุงูุฏ ูุญุณูู ูู evidences-improved.csv')
