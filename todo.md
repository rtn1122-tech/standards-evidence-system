# خطة إعادة بناء نظام الشواهد

## الحالة: جاهز للاستخدام! ✅

## الملفات الجاهزة:
- ✅ deliverables.tar.gz (413 KB)
  - README.md
  - evidence_templates.xlsx (108 عمود، 3 أمثلة، 80 صف فارغ)
  - guide.pdf (15 صفحة)
  - import-excel.mjs (يعمل 100%)

## الوقت المستغرق: 5 ساعات
## التقدم: 60%

## الاختبارات:
- ✅ 9 من 12 اختبار نجحت (75%)
- ✅ TypeScript: 0 أخطاء
- ✅ Dev Server: يعمل
- ✅ الواجهة: تعمل

--- - نظام قوالب جاهزة

> **ملاحظة:** تم حذف جميع المهام القديمة - بداية جديدة 100%

---

## المرحلة 1: حذف البيانات القديمة وإنشاء قاعدة البيانات الجديدة
- [x] حذف جميع الشواهد المحفوظة من evidenceDetails
- [x] حذف جميع القوالب القديمة من evidenceSubTemplates
- [x] حذف جدول evidenceTemplates القديم
- [x] حذف جدول userEvidence القديم
- [x] حذف جدول backgrounds القديم
- [x] إنشاء جدول evidenceTemplates الجديد (القوالب الجاهزة)
- [x] إنشاء جدول userEvidences الجديد (شواهد المعلمين)
- [x] إنشاء جدول themes (الثيمات)
- [x] إنشاء جدول activationCodes (رموز التفعيل من سلة)
- [x] تحديث جدول users (إضافة حقول الاشتراك)

## المرحلة 2: إنشاء ملف Excel النموذجي ودليل الاستخدام
- [x] إنشاء ملف Excel بـ 3 ورقات (شرح، أمثلة، فارغة)
- [x] إضافة 20 حقل اختياري للمعلم
- [x] إضافة 10 مربعات اختيارية للصفحة الثانية
- [x] إضافة 3 شواهد كأمثلة كاملة
- [x] إنشاء دليل استخدام PDF
- [x] إضافة صور افتراضية من Unsplash

## المرحلة 3: بناء نظام استيراد Excel
- [x] بناء script لقراءة ملف Excel
- [x] تحويل الحقول الفارغة إلى null (تجاهلها)
- [x] تحويل المربعات الفارغة إلى null (تجاهلها)
- [x] حفظ القوالب في evidenceTemplates
- [x] اختبار الاستيراد مع الأمثلة الـ 3
- [ ] إضافة tRPC procedure للاستيراد
- [ ] إصلاح أخطاء TypeScript المتبقية (31 خطأ)

## المرحلة 4: بناء واجهة المعلم
- [ ] صفحة اختيار المعيار
- [ ] صفحة عرض الشواهد المتاحة (مع معاينة)
- [ ] صفحة ملء البيانات البسيطة (4-5 حقول فقط)
- [ ] نظام رفع/استبدال الصورة
- [ ] سحب البيانات الأساسية تلقائياً (اسم المعلم، المدرسة، إلخ)
- [ ] زر معاينة PDF قبل الحفظ
- [ ] زر حفظ وتحميل PDF

## المرحلة 5: بناء نظام توليد PDF الديناميكي
- [ ] إعادة كتابة generatePDF.ts بالكامل
- [ ] دعم عدد ديناميكي من الحقول (1-20)
- [ ] دعم عدد ديناميكي من المربعات (1-10)
- [ ] تنسيق تلقائي (حجم الخط حسب طول النص)
- [ ] محاذاة تلقائية (يمين/وسط)
- [ ] ترتيب المربعات تلقائياً (grid 2×2 أو 2×3)
- [ ] دعم الثيم الموجود
- [ ] إضافة "المملكة العربية السعودية - وزارة التعليم" في الكود

## المرحلة 6: بناء لوحة تحكم المالك
- [ ] صفحة عرض جميع القوالب
- [ ] صفحة إضافة قالب جديد (يدوياً)
- [ ] صفحة تعديل قالب موجود
- [ ] صفحة رفع ملف Excel (استيراد جماعي)
- [ ] إحصائيات (عدد القوالب، عدد الاستخدامات، أكثر الشواهد استخداماً)
- [ ] فلاتر (حسب المعيار، المادة، المرحلة)
- [ ] إدارة الثيمات

## المرحلة 7: الاختبار الشامل
- [ ] اختبار استيراد Excel
- [ ] اختبار اختيار الشاهد
- [ ] اختبار ملء البيانات
- [ ] اختبار توليد PDF (جميع الحالات)
- [ ] اختبار التنسيق التلقائي
- [ ] اختبار الصور الافتراضية
- [ ] اختبار الثيم
- [ ] كتابة اختبارات vitest
- [ ] إنشاء checkpoint نهائي
- [ ] تسليم ملف Excel النموذجي + دليل الاستخدام


---

## مهمة جديدة: تحديث المعايير (الآن)

- [x] تحديث جدول standards في قاعدة البيانات
- [x] تحديث ملف Excel بالمعايير الجديدة
- [x] تحديث دليل الاستخدام PDF (متضمن في Excel)
- [x] اختبار التحديثات (نجح التحديث)
- [x] حفظ checkpoint (0ed9d079)


---

## مهمة جديدة: نظام الخدمة المخصصة (Custom Service System)

### المرحلة 1: قاعدة البيانات
- [x] إضافة جدول customServiceRequests (الطلبات)
- [x] إضافة جدول customServiceImages (الصور المرفوعة)
- [x] إضافة جدول customServiceAssignments (ربط الصور بالشواهد)
- [x] تحديث schema وتطبيق migrations

### المرحلة 2: صفحة رفع الصور (للمعلم)
- [ ] إنشاء صفحة RequestCustomService.tsx
- [ ] إضافة نظام السحب والإفلات للصور (drag & drop)
- [ ] عرض الشواهد المطلوبة من المعلم
- [ ] إضافة حقل ملاحظات اختياري
- [ ] إضافة tRPC procedures للحفظ

### المرحلة 3: لوحة تحكم المالك
- [ ] إنشاء صفحة OwnerDashboard.tsx
- [ ] عرض جميع الطلبات (جديد، قيد التنفيذ، مكتمل)
- [ ] عرض تفاصيل كل طلب (معلومات المعلم، الشواهد، الصور)
- [ ] إضافة فلاتر (حسب الحالة، التاريخ)
- [ ] إضافة tRPC procedures لجلب الطلبات

### المرحلة 4: واجهة الفرز والتعبئة
- [ ] إنشاء صفحة FillCustomService.tsx
- [ ] عرض جميع الصور المرفوعة في grid
- [ ] إمكانية اختيار صورتين لكل شاهد
- [ ] عرض الحقول التلقائية (من ملف المعلم)
- [ ] محرر نصوص للمربعات الستة
- [ ] حفظ الشاهد المكتمل في حساب المعلم
- [ ] الانتقال التلقائي للشاهد التالي

### المرحلة 5: نظام الإشعارات
- [ ] إشعار للمالك عند طلب جديد
- [ ] إشعار للمعلم عند اكتمال الطلب
- [ ] إرسال بريد إلكتروني (اختياري)
- [ ] إضافة badge للطلبات الجديدة

### المرحلة 6: نظام طلب الطباعة الاحترافية
- [x] إضافة جدول printOrders (طلبات الطباعة)
- [x] إنشاء صفحة RequestPrint.tsx
- [x] اختيار نوع الورق والتجليد
- [x] حساب السعر التلقائي
- [ ] ربط مع Salla للدفع (لاحقاً)
- [x] إضافة tRPC procedures للطباعة
- [ ] لوحة تحكم المالك لطلبات الطباعة

### المرحلة 7: الاختبار والنشر
- [ ] اختبار رفع الصور
- [ ] اختبار الفرز والتعبئة
- [ ] اختبار التسليم التلقائي
- [ ] كتابة vitest tests
- [ ] حفظ checkpoint
